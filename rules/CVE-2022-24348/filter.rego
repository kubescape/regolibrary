package armo_builtins

import rego.v1

deny contains msga if {
	deployment := input[_]
	deployment.kind == "Deployment"
	image := deployment.spec.template.spec.containers[i].image
	contains(image, "argocd:v")
	path := sprintf("spec.template.spec.containers[%v].image", [format_int(i, 10)])
	msga := {
		"alertMessage": "You may be vulnerable to CVE-2022-24348",
		"failedPaths": [path],
		"alertObject": {"k8SApiObjects": [deployment]},
	}
}
