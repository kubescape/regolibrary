{
  "name": "nginx-ingress-arbitrary-code-execution",
  "attributes": {},
  "ruleLanguage": "Rego",
  "match": [
    {
      "apiGroups": ["apps"],
      "apiVersions": ["v1"],
      "resources": ["Deployment", "DaemonSet", "StatefulSet"]
    },
    {
      "apiGroups": ["admissionregistration.k8s.io"],
      "apiVersions": ["v1"],
      "resources": ["ValidatingWebhookConfiguration"]
    }
  ],
  "ruleDependencies": [],
  "description": "Detects vulnerable versions of ingress-nginx controller susceptible to CVE-2025-1974 arbitrary code execution",
  "remediation": "Upgrade ingress-nginx to a patched version (v1.11.5+, v1.12.1+, or later). Alternatively, disable the Validating Admission Controller by either: (1) setting controller.admissionWebhooks.enabled=false in Helm, (2) deleting the ingress-nginx-admission ValidatingWebhookConfiguration, or (3) removing --validating-webhook from container arguments.",
  "ruleQuery": "armo_builtins"
}
