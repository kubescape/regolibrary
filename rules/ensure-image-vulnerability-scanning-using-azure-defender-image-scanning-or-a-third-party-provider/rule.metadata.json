{
    "name": "ensure-image-vulnerability-scanning-using-azure-defender-image-scanning-or-a-third-party-provider",
    "attributes": {
        "armoBuiltin": true
    },
    "ruleLanguage": "Rego",
    "match": [],
    "dynamicMatch": [
        {
            "apiGroups": [
                "management.azure.com"
            ],
            "apiVersions": [
                "v1"
            ],
            "resources": [
                "ClusterDescribe"
            ]
        }
    ],
    "relevantCloudProviders": ["AKS"],
    "ruleDependencies": [],
    "description": "Scan images being deployed to Azure (AKS) for vulnerabilities. Vulnerability scanning for images stored in Azure Container Registry is generally available in Azure Security Center. This capability is powered by Qualys, a leading provider of information security. When you push an image to Container Registry, Security Center automatically scans it, then checks for known vulnerabilities in packages or dependencies defined in the file. When the scan completes (after about 10 minutes), Security Center provides details and a security classification for each vulnerability detected, along with guidance on how to remediate issues and protect vulnerable attack surfaces.",
    "remediation": "Enable Azure Defender image scanning. Command: az aks update --enable-defender --resource-group <your-resource-group> --name <your-cluster-name>",
    "ruleQuery": "armo_builtin"
}