{
  "name": "CVE-2022-3172",
  "attributes": {
    "armoBuiltin": true
  },
  "ruleLanguage": "Rego",
  "match": [
    {
      "apiGroups": [
        "apiregistration.k8s.io"
      ],
      "apiVersions": [
        "v1"
      ],
      "resources": [
        "APIService"
      ]
    },
    {
      "apiGroups": [
        ""
      ],
      "apiVersions": [
        "v1"
      ],
      "resources": [
        "Service"
      ]
    }
  ],
  "dynamicMatch": [
    {
      "apiGroups": [
        "apiserverinfo.kubescape.cloud"
      ],
      "apiVersions": [
        "v1beta0"
      ],
      "resources": [
        "APIServerInfo"
      ]
    }
  ],
  "ruleDependencies": [],
  "description": "List aggregated API server APIServices if kube-api-server version is vulnerable to CVE-2022-3172",
  "remediation": "Upgrade the Kubernetes version to one of the fixed versions. The following versions are fixed: `v1.25.1`, `v1.24.5`, `v1.23.11`, `v1.22.14`",
  "ruleQuery": ""
}