{
  "controlID": "C-0165",
  "name": "If proxy kubeconfig file exists ensure ownership is set to root:root",
  "description": "If `kube-proxy` is running, ensure that the file ownership of its kubeconfig file is set to `root:root`.",
  "long_description": "The kubeconfig file for `kube-proxy` controls various parameters for the `kube-proxy` service in the worker node. You should set its file ownership to maintain the integrity of the file. The file should be owned by `root:root`.",
  "remediation": "Run the below command (based on the file location on your system) on the each worker node. For example, ```chown root:root <proxy kubeconfig file>```",
  "manual_test": "Find the kubeconfig file being used by `kube-proxy` by running the following command: ```ps -ef | grep kube-proxy``` If `kube-proxy` is running, get the kubeconfig file location from the `--kubeconfig` parameter. To perform the audit: Run the below command (based on the file location on your system) on the each worker node. For example, ```stat -c %U:%G <path><filename>``` Verify that the ownership is set to `root:root`.",
  "references": [
    "https://workbench.cisecurity.org/sections/1126659/recommendations/1838603"
  ],
  "rulesNames": [
    "if-proxy-kubeconfig-file-exists-ensure-ownership-is-set-to-root-root"
  ],
  "attributes": {
    "armoBuiltin": true
  },
  "baseScore": 6,
  "impact_statement": "None",
  "default_value": "By default, `proxy` file ownership is set to `root:root`.",
  "scanningScope": {
    "matches": [
      [
        "cluster",
        "cloud"
      ]
    ]
  }
}
