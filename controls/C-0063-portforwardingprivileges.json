{
  "name": "Portforwarding privileges",
  "attributes": {
    "armoBuiltin": true,
    "rbacQuery": "Port Forwarding",
    "controlTypeTags": [
      "security-impact",
      "compliance"
    ],
    "attackTracks": [
      {
        "attackTrack": "kubeapi",
        "categories": [
          "Impact - data destruction",
          "Discovery",
          "Lateral movement"
        ]
      }
    ]
  },
  "description": "Attackers with relevant RBAC permission can use “kubectl portforward” command to establish direct communication with PODs from within the cluster or even remotely. Such communication will most likely bypass existing security measures in the cluster. This control determines which subjects have permissions to use this command.",
  "remediation": "It is recommended to prohibit “kubectl portforward” command in production environments. It is also recommended not to use subjects with this permission for daily cluster operations.",
  "rulesNames": [
    "rule-can-portforward",
    "rule-can-portforward-v1"
  ],
  "long_description": "Attackers who have relevant RBAC permissions, can run open a backdoor communication channel directly to the sockets inside target container using exec command “kubectl portforward” command. Using this method, attackers can bypass network security restrictions and communicate directly with software in the containers.",
  "test": "Check which subjects have RBAC permissions to portforward into pods– if they have the “pods/portforward” resource.",
  "controlID": "C-0063",
  "baseScore": 5,
  "example": "@controls/examples/c063.yaml",
  "scanningScope": {
    "matches": [
      [
        "cluster"
      ],
      [
        "file"
      ]
    ]
  }
}
